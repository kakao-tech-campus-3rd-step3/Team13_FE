name: CD

on:
  workflow_run:
    workflows: ["CI"]
    branches: [main, develop]
    types:
      - completed

jobs:
  deploy:
    runs-on: ubuntu-latest
    # CI ì›Œí¬í”Œë¡œìš°ê°€ ì„±ê³µí–ˆì„ ë•Œë§Œ ì‹¤í–‰
    if: ${{ github.event.workflow_run.conclusion == 'success' }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js from .nvmrc
        uses: actions/setup-node@v4
        with:
          node-version-file: '.nvmrc'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build for deployment
        run: npm run build

      - name: Deploy to Vercel
        run: |
          echo "ğŸš€ Deployment will be handled by Vercel Git integration"
          echo "âœ… CI passed, deployment triggered automatically"
          echo "Branch: ${{ github.event.workflow_run.head_branch }}"
          echo "Commit: ${{ github.event.workflow_run.head_sha }}"